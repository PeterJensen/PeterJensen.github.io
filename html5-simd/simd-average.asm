; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.30319.01 

	TITLE	I:\html5\html5-simd\simd-average.cpp
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB LIBCMT
INCLUDELIB OLDNAMES

PUBLIC	__real@00000000
PUBLIC	?average@@YAMPAMH@Z				; average
EXTRN	__fltused:DWORD
;	COMDAT __real@00000000
; File i:\html5\html5-simd\simd-average.cpp
CONST	SEGMENT
__real@00000000 DD 000000000r			; 0
; Function compile flags: /Ogtpy
CONST	ENDS
;	COMDAT ?average@@YAMPAMH@Z
_TEXT	SEGMENT
tv553 = -4						; size = 4
tv550 = -4						; size = 4
tv547 = -4						; size = 4
_sum$ = -4						; size = 4
_src$ = 8						; size = 4
tv541 = 12						; size = 4
_len$ = 12						; size = 4
?average@@YAMPAMH@Z PROC				; average, COMDAT
; Line 4
	push	ecx
; Line 5
	fldz
	push	esi
; Line 6
	mov	esi, DWORD PTR _len$[esp+4]
	fstp	DWORD PTR _sum$[esp+8]
	xor	edx, edx
	push	edi
	mov	edi, DWORD PTR _src$[esp+8]
	cmp	esi, 4
	jl	SHORT $LC9@average
; Line 5
	lea	ecx, DWORD PTR [esi-4]
	shr	ecx, 2
	inc	ecx
	lea	eax, DWORD PTR [edi+8]
	lea	edx, DWORD PTR [ecx*4]
	npad	7
; Line 6
$LL10@average:
; Line 7
	fld	DWORD PTR [eax-8]
	add	eax, 16					; 00000010H
	dec	ecx
	fadd	DWORD PTR _sum$[esp+12]
	fstp	DWORD PTR tv553[esp+12]
	fld	DWORD PTR tv553[esp+12]
	fadd	DWORD PTR [eax-20]
	fstp	DWORD PTR tv550[esp+12]
	fld	DWORD PTR tv550[esp+12]
	fadd	DWORD PTR [eax-16]
	fstp	DWORD PTR tv547[esp+12]
	fld	DWORD PTR tv547[esp+12]
	fadd	DWORD PTR [eax-12]
	fstp	DWORD PTR _sum$[esp+12]
	jne	SHORT $LL10@average
$LC9@average:
; Line 6
	cmp	edx, esi
	jge	SHORT $LN8@average
$LC3@average:
; Line 7
	fld	DWORD PTR [edi+edx*4]
	inc	edx
	fadd	DWORD PTR _sum$[esp+12]
	fstp	DWORD PTR _sum$[esp+12]
	cmp	edx, esi
	jl	SHORT $LC3@average
$LN8@average:
; Line 9
	fld	DWORD PTR _sum$[esp+12]
	pop	edi
	fidiv	DWORD PTR _len$[esp+4]
	pop	esi
	fstp	DWORD PTR tv541[esp]
	fld	DWORD PTR tv541[esp]
; Line 10
	pop	ecx
	ret	0
?average@@YAMPAMH@Z ENDP				; average
_TEXT	ENDS
PUBLIC	__$ArrayPad$
PUBLIC	?simdAverage@@YAMPAMH@Z				; simdAverage
EXTRN	___security_cookie:DWORD
EXTRN	@__security_check_cookie@4:PROC
; Function compile flags: /Ogtpy
;	COMDAT ?simdAverage@@YAMPAMH@Z
_TEXT	SEGMENT
tv186 = -24						; size = 4
_sumx4_mem$ = -20					; size = 16
__$ArrayPad$ = -4					; size = 4
_src$ = 8						; size = 4
_len$ = 12						; size = 4
?simdAverage@@YAMPAMH@Z PROC				; simdAverage, COMDAT
; Line 12
	sub	esp, 24					; 00000018H
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+24], eax
; Line 14
	mov	eax, DWORD PTR _len$[esp+20]
	mov	ecx, DWORD PTR _src$[esp+20]
	xorps	xmm0, xmm0
	test	eax, eax
	jle	SHORT $LN1@simdAverag
	dec	eax
	shr	eax, 2
	inc	eax
$LL3@simdAverag:
; Line 15
	movups	xmm1, XMMWORD PTR [ecx]
; Line 16
	add	ecx, 16					; 00000010H
	dec	eax
	addps	xmm0, xmm1
	jne	SHORT $LL3@simdAverag
$LN1@simdAverag:
; Line 19
	movups	XMMWORD PTR _sumx4_mem$[esp+24], xmm0
; Line 20
	fld	DWORD PTR _sumx4_mem$[esp+28]
	fadd	DWORD PTR _sumx4_mem$[esp+24]
; Line 21
	mov	ecx, DWORD PTR __$ArrayPad$[esp+24]
	xor	ecx, esp
	fadd	DWORD PTR _sumx4_mem$[esp+32]
	fadd	DWORD PTR _sumx4_mem$[esp+36]
	fidiv	DWORD PTR _len$[esp+20]
	fstp	DWORD PTR tv186[esp+24]
	fld	DWORD PTR tv186[esp+24]
	call	@__security_check_cookie@4
	add	esp, 24					; 00000018H
	ret	0
?simdAverage@@YAMPAMH@Z ENDP				; simdAverage
_TEXT	ENDS
PUBLIC	?init@@YAXPAMH@Z				; init
; Function compile flags: /Ogtpy
;	COMDAT ?init@@YAXPAMH@Z
_TEXT	SEGMENT
_i$4588 = -4						; size = 4
_dst$ = 8						; size = 4
_len$ = 12						; size = 4
?init@@YAXPAMH@Z PROC					; init, COMDAT
; Line 23
	push	ecx
; Line 24
	mov	ecx, DWORD PTR _len$[esp]
	xor	eax, eax
	mov	DWORD PTR _i$4588[esp+4], eax
	test	ecx, ecx
	jle	SHORT $LN1@init
	mov	edx, DWORD PTR _dst$[esp]
$LL3@init:
; Line 25
	fild	DWORD PTR _i$4588[esp+4]
	inc	eax
	mov	DWORD PTR _i$4588[esp+4], eax
	fstp	DWORD PTR [edx+eax*4-4]
	cmp	eax, ecx
	jl	SHORT $LL3@init
$LN1@init:
; Line 27
	pop	ecx
	ret	0
?init@@YAXPAMH@Z ENDP					; init
_TEXT	ENDS
PUBLIC	??_C@_0BC@IIOFCPOC@simdAverage?5?$DN?5?$CFf?6?$AA@ ; `string'
PUBLIC	__real@40f86a0000000000
PUBLIC	??_C@_0O@DKNFJEBH@average?5?$DN?5?$CFf?6?$AA@	; `string'
PUBLIC	__$ArrayPad$
PUBLIC	_main
EXTRN	_printf:PROC
EXTRN	__chkstk:PROC
;	COMDAT ??_C@_0BC@IIOFCPOC@simdAverage?5?$DN?5?$CFf?6?$AA@
CONST	SEGMENT
??_C@_0BC@IIOFCPOC@simdAverage?5?$DN?5?$CFf?6?$AA@ DB 'simdAverage = %f', 0aH
	DB	00H						; `string'
CONST	ENDS
;	COMDAT __real@40f86a0000000000
CONST	SEGMENT
__real@40f86a0000000000 DQ 040f86a0000000000r	; 100000
CONST	ENDS
;	COMDAT ??_C@_0O@DKNFJEBH@average?5?$DN?5?$CFf?6?$AA@
CONST	SEGMENT
??_C@_0O@DKNFJEBH@average?5?$DN?5?$CFf?6?$AA@ DB 'average = %f', 0aH, 00H ; `string'
; Function compile flags: /Ogtpy
CONST	ENDS
;	COMDAT _main
_TEXT	SEGMENT
tv207 = -400024						; size = 4
_i$4641 = -400024					; size = 4
_f32a$ = -400020					; size = 400000
_sumx4_mem$4657 = -20					; size = 16
__$ArrayPad$ = -4					; size = 4
_main	PROC						; COMDAT
; Line 29
	mov	eax, 400024				; 00061a98H
	call	__chkstk
	mov	eax, DWORD PTR ___security_cookie
	xor	eax, esp
	mov	DWORD PTR __$ArrayPad$[esp+400024], eax
; Line 33
	xor	eax, eax
	mov	DWORD PTR _i$4641[esp+400024], eax
	npad	3
$LL5@main:
	fild	DWORD PTR _i$4641[esp+400024]
	inc	eax
	mov	DWORD PTR _i$4641[esp+400024], eax
	fstp	DWORD PTR _f32a$[esp+eax*4+400020]
	cmp	eax, 100000				; 000186a0H
	jl	SHORT $LL5@main
; Line 34
	lea	eax, DWORD PTR _f32a$[esp+400024]
	push	100000					; 000186a0H
	push	eax
	call	?average@@YAMPAMH@Z			; average
; Line 35
	fstp	QWORD PTR [esp]
	push	OFFSET ??_C@_0O@DKNFJEBH@average?5?$DN?5?$CFf?6?$AA@
	call	_printf
	add	esp, 12					; 0000000cH
; Line 36
	lea	eax, DWORD PTR _f32a$[esp+400024]
	xorps	xmm0, xmm0
	mov	ecx, 25000				; 000061a8H
	npad	4
$LL10@main:
	movups	xmm1, XMMWORD PTR [eax]
	add	eax, 16					; 00000010H
	dec	ecx
	addps	xmm0, xmm1
	jne	SHORT $LL10@main
	movups	XMMWORD PTR _sumx4_mem$4657[esp+400024], xmm0
; Line 37
	fld	DWORD PTR _sumx4_mem$4657[esp+400028]
	fadd	DWORD PTR _sumx4_mem$4657[esp+400024]
	sub	esp, 8
	fadd	DWORD PTR _sumx4_mem$4657[esp+400040]
	fadd	DWORD PTR _sumx4_mem$4657[esp+400044]
	fdiv	QWORD PTR __real@40f86a0000000000
	fstp	DWORD PTR tv207[esp+400032]
	fld	DWORD PTR tv207[esp+400032]
	fstp	QWORD PTR [esp]
	push	OFFSET ??_C@_0BC@IIOFCPOC@simdAverage?5?$DN?5?$CFf?6?$AA@
	call	_printf
; Line 38
	mov	ecx, DWORD PTR __$ArrayPad$[esp+400036]
	add	esp, 12					; 0000000cH
	xor	ecx, esp
	xor	eax, eax
	call	@__security_check_cookie@4
	add	esp, 400024				; 00061a98H
	ret	0
_main	ENDP
_TEXT	ENDS
END
